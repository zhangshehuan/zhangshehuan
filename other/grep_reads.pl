#!/usr/bin/perl
use strict;
use warnings;
my $notrim_158sam="/share/workspaces/zhangshehuan/Test_out/Mt_fusion/"
				."fusion_mock/saian_notrim/20180301158_S14_L001_R1_001/"
				."trim/20180301158_S14_L001_R1_001.trimmed.hg19.sam";
my $trim_158sam="/share/workspaces/zhangshehuan/Test_out/Mt_fusion/"
				."fusion_mock/saian_trim/20180301158_S14_L001_R1_001/"
				."trim/20180301158_S14_L001_R1_001.trimmed.hg19.sam";
my $notrim_156sam="/share/workspaces/zhangshehuan/Test_out/Mt_fusion/"
				."fusion_mock/saian_notrim/20180302156_S9_L001_R1_001/"
				."trim/20180302156_S9_L001_R1_001.trimmed.hg19.sam";
my $trim_156sam="/share/workspaces/zhangshehuan/Test_out/Mt_fusion/"
				."fusion_mock/saian_trim/20180302156_S9_L001_R1_001/"
				."trim/20180302156_S9_L001_R1_001.trimmed.hg19.sam";
my $notrim_158=<<USAGE;
GGGGCTTAGGGC:MN00129:44:000H27VFJ:1:23106:16571:13926,GCGGGGGGGGTA:MN00129:44:000H27VFJ:1:11108:4840:6882,TTGTTAGCCATA:MN00129:44:000H27VFJ:1:13109:3550:8174,CGGGGTGGGGGG:MN00129:44:000H27VFJ:1:11106:2824:7910,GGGGCTTAGGGC:MN00129:44:000H27VFJ:1:12102:3948:5198,GAGGGTTAAGGT:MN00129:44:000H27VFJ:1:22106:7870:3442,AGGTTCGCTCAT:MN00129:44:000H27VFJ:1:22102:15768:13956,GGGATGTTGCAA:MN00129:44:000H27VFJ:1:11103:26567:10351,TCCATGGTGATA:MN00129:44:000H27VFJ:1:12103:22406:18841,GGGCAGTGTGCG:MN00129:44:000H27VFJ:1:22109:22620:4186,TTGCATTTCTCA:MN00129:44:000H27VFJ:1:23103:25069:1348
USAGE
my $trim_158=<<USAGE;
GGGGGTTGGGGT:MN00129:44:000H27VFJ:1:21106:11886:2089,TTCAACAGCCCA:MN00129:44:000H27VFJ:1:12110:8823:17181,CCAAGCGATAAA:MN00129:44:000H27VFJ:1:13103:10378:5905,GGGGGTTGGGGT:MN00129:44:000H27VFJ:1:13107:1289:7267,GCCTCGAACTGG:MN00129:44:000H27VFJ:1:21107:24916:3365,GTATATTTCATA:MN00129:44:000H27VFJ:1:12106:4765:18933,GCTGTGCCGCCC:MN00129:44:000H27VFJ:1:13103:22030:13846,TGGGGGGGGGTG:MN00129:44:000H27VFJ:1:23108:18880:19652,TCACAAATGGAT:MN00129:44:000H27VFJ:1:12107:23009:18610,GCTGTGCCGCCC:MN00129:44:000H27VFJ:1:13109:23705:8663,GGGCATATCGGG:MN00129:44:000H27VFJ:1:12106:20288:14468,CGCTACCTACGG:MN00129:44:000H27VFJ:1:12104:1643:14888,AGGTTCGCTCAT:MN00129:44:000H27VFJ:1:22102:15768:13956,TTGCATTTCTCA:MN00129:44:000H27VFJ:1:23103:25069:1348
USAGE
my $notrim_156=<<USAGE;
AGTGGGGGATGG:MN00129:44:000H27VFJ:1:12108:1122:15779,TAAAATTTATCT:MN00129:44:000H27VFJ:1:12104:16865:2402,TGTCTTATGCAT:MN00129:44:000H27VFJ:1:13110:3803:13127,GTGAGAGATGTA:MN00129:44:000H27VFJ:1:12103:15450:19138,TGTCTTATGCAT:MN00129:44:000H27VFJ:1:21107:23184:17759,GGGGCGTGATTG:MN00129:44:000H27VFJ:1:22110:22348:6461,TGCAGTTGAGGG:MN00129:44:000H27VFJ:1:13109:25749:19072,AGTGGGGGATGG:MN00129:44:000H27VFJ:1:22101:26371:1821,GGGGCGTGATTG:MN00129:44:000H27VFJ:1:11103:14592:7938,CCGGGGGGGGCG:MN00129:44:000H27VFJ:1:23103:24717:19591,TCATCCACGTAT:MN00129:44:000H27VFJ:1:12107:1704:9107,TGGACTGGTGGC:MN00129:44:000H27VFJ:1:12106:19555:19889,TGTTGGCCTGGT:MN00129:44:000H27VFJ:1:23107:23952:2625,GGTCAAAGGGGT:MN00129:44:000H27VFJ:1:12109:1724:18459,TTGTCAGGGGAA:MN00129:44:000H27VFJ:1:11107:24968:6886,TCTGCGAGTCGT:MN00129:44:000H27VFJ:1:12103:11600:6363,TTTGGTTTTTTA:MN00129:44:000H27VFJ:1:22102:26509:19767,TATCGCGTGTGA:MN00129:44:000H27VFJ:1:11110:24362:17893,GGCTTCGAGGGG:MN00129:44:000H27VFJ:1:12104:4200:6027,CGACGTGTGCGC:MN00129:44:000H27VFJ:1:22104:1742:19476,TTGGCGGCTAAT:MN00129:44:000H27VFJ:1:13106:9946:8937,ACGTCATTACCC:MN00129:44:000H27VFJ:1:21105:15729:16706,GGGCATTAATTC:MN00129:44:000H27VFJ:1:12109:3507:18953,ATGAGTTGTGGT:MN00129:44:000H27VFJ:1:13102:19341:2566,TAGGGGAGTGCT:MN00129:44:000H27VFJ:1:11107:13998:14295,CTTCGGTGCCAC:MN00129:44:000H27VFJ:1:23108:17355:3669,CGGGGTACGCTT:MN00129:44:000H27VFJ:1:22106:17537:7708,GGGGATGTGGTG:MN00129:44:000H27VFJ:1:21110:4425:8937,GTGCTGCCACTG:MN00129:44:000H27VFJ:1:13108:2744:2401,GGGGCTAGCCGC:MN00129:44:000H27VFJ:1:21105:20275:7175,GGTCAAAGGGGT:MN00129:44:000H27VFJ:1:22103:25659:19953,CTTCGGTGCCAC:MN00129:44:000H27VFJ:1:13110:2596:6949,CGGAAGCATGGT:MN00129:44:000H27VFJ:1:22102:26690:18853,GTGAGAGATGTA:MN00129:44:000H27VFJ:1:13105:9600:19094,CTTCGGTGCCAC:MN00129:44:000H27VFJ:1:12110:26478:19786,CACAGCAGTGTT:MN00129:44:000H27VFJ:1:12109:11817:19439,TAAAATTTATCT:MN00129:44:000H27VFJ:1:13110:7193:3743,GCACTGGGGTTA:MN00129:44:000H27VFJ:1:13110:1262:14614,CTTCGGTGCCAC:MN00129:44:000H27VFJ:1:12109:26152:16867,TGGATAGAGGTG:MN00129:44:000H27VFJ:1:22106:5430:5556,GGGATGGCTGAC:MN00129:44:000H27VFJ:1:23107:12367:3041,CGGGCCTCTTAC:MN00129:44:000H27VFJ:1:13105:25019:19292,TATGTCATCGGC:MN00129:44:000H27VFJ:1:11104:4301:10059,GGGGCGTGATTG:MN00129:44:000H27VFJ:1:13105:1474:3981,GGGAACTGGGCA:MN00129:44:000H27VFJ:1:21107:17199:11006,GATGGCCGAATC:MN00129:44:000H27VFJ:1:21105:6319:19717,CTCGATTAAGGA:MN00129:44:000H27VFJ:1:23110:7815:3718,TTTTCATGACTC:MN00129:44:000H27VFJ:1:21105:22151:15373,TGTTGAGCGCCG:MN00129:44:000H27VFJ:1:11107:17328:6214,AAATGACTGTAC:MN00129:44:000H27VFJ:1:11104:4032:1551,TAGGGTTTGGGT:MN00129:44:000H27VFJ:1:12102:23577:1917,AGGGGTGGGGTT:MN00129:44:000H27VFJ:1:13105:20386:20282
USAGE
my $trim_156=<<USAGE;
TGTTGAGCGCCG:MN00129:44:000H27VFJ:1:21107:6876:15971,AGTGGGGGATGG:MN00129:44:000H27VFJ:1:12108:1122:15779,TAAAATTTATCT:MN00129:44:000H27VFJ:1:12104:16865:2402,TGTCTTATGCAT:MN00129:44:000H27VFJ:1:13110:3803:13127,TTGGGGGTGGTG:MN00129:44:000H27VFJ:1:13109:21800:19964,GGGCATTAATTC:MN00129:44:000H27VFJ:1:22107:24997:18896,TGCCTAGAGCCA:MN00129:44:000H27VFJ:1:21103:7501:10047,TATGCACAACAA:MN00129:44:000H27VFJ:1:23103:5517:2338,TGCAGTTGAGGG:MN00129:44:000H27VFJ:1:13109:25749:19072,AACAGGGGGTGG:MN00129:44:000H27VFJ:1:11103:13412:13763,CGGGCCTCTTAC:MN00129:44:000H27VFJ:1:12102:13450:14175,CTCGATTAAGGA:MN00129:44:000H27VFJ:1:13110:18288:1702,GGGCGGGGGTAG:MN00129:44:000H27VFJ:1:23108:12770:19045,TGTTGGCCTGGT:MN00129:44:000H27VFJ:1:23107:23952:2625,AGTGGGGGATGG:MN00129:44:000H27VFJ:1:21102:24908:15169,ATTGGGACATAG:MN00129:44:000H27VFJ:1:22101:13328:20176,TCTGATCCGTTC:MN00129:44:000H27VFJ:1:13107:8100:20185,GACCGGCAGCCG:MN00129:44:000H27VFJ:1:22103:24242:3756,GGTCAAAGGGGT:MN00129:44:000H27VFJ:1:12109:15784:1920,CAGATACGTGCC:MN00129:44:000H27VFJ:1:22102:23552:5342,ACGTCATTACCC:MN00129:44:000H27VFJ:1:21105:15729:16706,AAATGACTGTAC:MN00129:44:000H27VFJ:1:23106:20747:9901,GGGCATTAATTC:MN00129:44:000H27VFJ:1:12109:3507:18953,TGTTTAATAGGA:MN00129:44:000H27VFJ:1:11102:4758:6782,TGGACTGGTGGC:MN00129:44:000H27VFJ:1:12109:6340:19632,GTGCTGCCACTG:MN00129:44:000H27VFJ:1:13108:2744:2401,GGGGATGTGGTG:MN00129:44:000H27VFJ:1:21110:4425:8937,GGGGCTAGCCGC:MN00129:44:000H27VFJ:1:21105:20275:7175,GCTAGGGGGCAG:MN00129:44:000H27VFJ:1:11104:20245:4982,GGGCTATGGGGG:MN00129:44:000H27VFJ:1:12106:23817:18848,AGTGGGGGATGG:MN00129:44:000H27VFJ:1:23102:26005:11245,TCATCCACGTAT:MN00129:44:000H27VFJ:1:22110:10300:1419,AGTGACGGGCAG:MN00129:44:000H27VFJ:1:11108:16582:3840,TAAAATTTATCT:MN00129:44:000H27VFJ:1:13110:7193:3743,TCATCCACGTAT:MN00129:44:000H27VFJ:1:12106:8871:10294,GCACTGGGGTTA:MN00129:44:000H27VFJ:1:13110:1262:14614,CAGACATAGTTA:MN00129:44:000H27VFJ:1:22104:2720:1205,ATCATGACTGAG:MN00129:44:000H27VFJ:1:21105:23807:5554,CGACGTGTGCGC:MN00129:44:000H27VFJ:1:13107:2439:15766,GGCCGTGGGGAC:MN00129:44:000H27VFJ:1:22105:15385:2472,GGGCGGGGGTAG:MN00129:44:000H27VFJ:1:13106:5476:10121,GGATCATGAGGG:MN00129:44:000H27VFJ:1:13109:5473:19645,TCGCGCGGCCCG:MN00129:44:000H27VFJ:1:12102:5991:8990,GGGGGCGGAGGG:MN00129:44:000H27VFJ:1:23102:20714:19445,GGGATGGCTGAC:MN00129:44:000H27VFJ:1:23107:12367:3041,CGGGCCTCTTAC:MN00129:44:000H27VFJ:1:13105:25019:19292,GGGGCTCGTTTA:MN00129:44:000H27VFJ:1:11110:7320:13984,GGCAATGGGCCG:MN00129:44:000H27VFJ:1:23109:13008:18568,GGGGCTAGCCGC:MN00129:44:000H27VFJ:1:22103:6058:18752,GGGGGTCGGAGT:MN00129:44:000H27VFJ:1:12104:3367:8633,GCACTGGGGTTA:MN00129:44:000H27VFJ:1:21106:1285:15951,GGGGCATTGCGT:MN00129:44:000H27VFJ:1:11108:7872:16778,ACAGGGGTGACT:MN00129:44:000H27VFJ:1:22109:15337:18268,GAGCATAGATGT:MN00129:44:000H27VFJ:1:11108:25197:5327,GGGAACTGGGCA:MN00129:44:000H27VFJ:1:21107:17199:11006,TGATGGGCAGGG:MN00129:44:000H27VFJ:1:12102:3866:19639,GTTTATCCAGTT:MN00129:44:000H27VFJ:1:11105:26488:11402,AGTCCGTCACGG:MN00129:44:000H27VFJ:1:23108:18885:4723,GCTTTTCATGGA:MN00129:44:000H27VFJ:1:13102:19214:3187,TGCCTAGAGCCA:MN00129:44:000H27VFJ:1:13105:3077:11315,GGGCTATGGGGG:MN00129:44:000H27VFJ:1:12102:4952:17094,GCCGAGTAGTTT:MN00129:44:000H27VFJ:1:22104:8072:1649,TGTTGAGCGCCG:MN00129:44:000H27VFJ:1:11107:17328:6214,TAGGGTTTGGGT:MN00129:44:000H27VFJ:1:12102:23577:1917,GCTTTTCATGGA:MN00129:44:000H27VFJ:1:13107:16428:2037
USAGE
&see ($notrim_158sam,$trim_158sam,$notrim_158,$trim_158,"158_trimORnotrim_info");
&see ($notrim_156sam,$trim_156sam,$notrim_156,$trim_156,"156_trimORnotrim_info");

sub see {
	my ($notrim_sam,$trim_sam,$notrim_seq,$trim_seq,$out)=@_;
	$notrim_seq=~s/\s+//g;
	$trim_seq=~s/\s+//g;
	my @arr_notrim=split/,/,$notrim_seq;
	my @arr_trim=split/,/,$trim_seq;
	my (%no,@yes_uniq);
	foreach my $i (@arr_notrim) {
		$no{$i}=1;
	}
	open OUT,">","$out" or die "Can't open '$out': $!\n";
	print OUT "both start\n";
	foreach my $i (@arr_trim) {
		if (exists $no{$i}) {
			print OUT "\t$i\n";
			delete $no{$i};
		}else {
			push @yes_uniq,$i;
		}
	}
	print OUT "both end\n";
	my @no_uniq=keys %no;
	print OUT "uniqtrim in notrim start\n";
	foreach my $e (@yes_uniq) {
		my $info=`grep \"$e\" $notrim_sam`;
		print OUT "$info";
		chomp (my $info_num=`grep \"$e\" $notrim_sam|wc -l`);
		if ($info_num<=2) {
			print "err '$info'\n"
		}
	}
	print OUT "uniqtrim in notrim end\n";
	print OUT "uniqnotrim in trim start\n";
	foreach my $e (@no_uniq) {
		my $info=`grep \"$e\" $trim_sam`;
		print OUT "$info";
		if ($info ne '') {
			print "err '$info'\n"
		}
	}
	print OUT "uniqnotrim in trim end\n";
	close OUT;
}

